<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Whatsapp</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h2>All Chats</h2>
    <form action="/chats/new" method="get">
        <button>New Chat</button>
    </form>
    <br><br>
    <% for(let chat of chats){ %>
        <div class="block">
            <div class="date">
                <% const createdAt=new Date(chat.created_at); const date=createdAt.getDate() + '-' +
                    (createdAt.getMonth() + 1) + '-' + createdAt.getFullYear(); const time=createdAt.getHours() + ':' +
                    createdAt.getMinutes(); %>
                    <p>
                        <%=date%>
                    </p>
            </div>
            <p>From : <b><i>
                        <%= chat.from %>
                    </i></b>
            </p>
            <!-- <div class="msg">
                <p>
                    <%= chat.message %>
                        <form action="/chats/<%= chat._id %>/edit" method="get">
                            <button>Edit</button>
                        </form>
                        <br>
                        <form action="/chats/<%=chat._id%>?_method=DELETE" method="POST"
                            onsubmit="return confirmDelete()">
                            <button type="submit">Delete</button>
                        </form>
                </p>
            </div> -->

            <div class="msg">
                <p>
                    <%= chat.message %>
                    <div class="inline">
                        <form action="/chats/<%= chat._id %>/edit" method="get">
                            <button class="btn">Edit</button>
                        </form>

                        <form action="/chats/<%=chat._id%>?_method=DELETE" method="POST"
                            onsubmit="return confirmDelete()">
                            <button type="submit">Delete</button>
                        </form>
                    </div>
                </p>
            </div>


            <p>Receive to <b><i>
                        <%= chat.to %>
                    </i></b>
            </p>
            <hr>
            <div>
                <p class="time">
                    <%= time %>
                </p>
            </div>
        </div>
        <% } %>
            <script>
                function confirmDelete() {
                    return confirm("Are you sure you want to delete this chat?");
                }
            </script>
</body>

</html>